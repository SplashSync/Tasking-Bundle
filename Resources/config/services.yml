services:

########################################################################
#   TASKING BUNDLE OPERATIONNAL SERVICES
########################################################################

########################################################################
# Tasks Management Service
    TaskingService:
        class: Splash\Tasking\Services\TaskingService
        arguments: ["@doctrine.orm.entity_manager", "@service_container"]   
#        lazy: true

########################################################################
# Tasks Management Event Listener
# This Event is Triggered when User Log In to Start Workers if Needed
    Tasking.EventListener:
        class:      Splash\Tasking\EventListener\TaskingEventListener
        arguments:  ["@service_container"]
        tags:
#            - { name: kernel.event_listener, event: 'security.interactive_login', method: onSecurityInteractiveLogin }
            - { name: kernel.event_listener, event: tasking.add, method: onAddAction }
            - { name: kernel.event_listener, event: tasking.insert, method: onInsertAction }
            - { name: kernel.event_listener, event: console.exception }

########################################################################
#   TASKING BUNDLE SONATA ADMIN SERVICES
########################################################################

########################################################################
# Tasks Sonata Admin Service
    sonata.admin.tasks:
        class: Splash\Tasking\Admin\TaskAdmin
        tags:
            - { name: sonata.admin, manager_type: orm, group: "System", label: "Tasks" }
        arguments:
            - ~
            - Splash\Tasking\Entity\Task
            - ~
        calls:
            - [ setTranslationDomain, [TaskingBundle]]
            
########################################################################
# Workers Sonata Admin Service
    sonata.admin.workers:
        class: Splash\Tasking\Admin\WorkerAdmin
        tags:
            - { name: sonata.admin, manager_type: orm, group: "System", label: "Workers" }
        arguments:
            - ~
            - Splash\Tasking\Entity\Worker
            - ~
        calls:
            - [ setTranslationDomain, [TaskingBundle]]            
            
########################################################################
# Tokens Sonata Admin Service
    sonata.admin.tokens:
        class: Splash\Tasking\Admin\TokenAdmin
        tags:
            - { name: sonata.admin, manager_type: orm, group: "System", label: "Token" }
        arguments:
            - ~
            - Splash\Tasking\Entity\Token
            - ~
        calls:
            - [ setTranslationDomain, [TaskingBundle]]  